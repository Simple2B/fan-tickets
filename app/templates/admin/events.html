{% extends 'base.html' %}
{% block links %}
<link rel="stylesheet" href="">
<script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/1.8.0/datepicker.min.js"></script>
{% endblock %}
{% block content %}
<div class="relative overflow-x-auto shadow-md sm:rounded-lg">
  <div class="mt-3 flex justify-between">
    <p class="mt-6 mb-2 ml-3 text-3xl dark:text-gray-400">Events</p>

    <a href="{{url_for('admin.add_event')}}" class="w-44 mx-3 my-6">
      <button type="button"
        class="link p-2 w-44 text-center text-secondary border border-secondary rounded-xl transition-colors duration-200">
        Add
      </button>
    </a>
  </div>

  <form action="{{url_for('admin.get_events')}}" class="m-3">
    <div class="flex justify-between">
      <div class="cursor-pointer">
        <p class="text-gray-400">Location</p>
        <select name="location_id"
          class="admin-select w-40 bg-black text-gray-400 border border-gray-400 rounded-lg cursor-pointer">
          <option value="all">All</option>
          {% for location in locations %}
          <option value="{{ location.id }}">{{ location.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="relative cursor-pointer">
        <p class="text-gray-400">Dates</p>
        <div id="event-dates"
          class="admin-select w-40 h-10 flex items-center bg-black text-gray-400 border border-gray-400 rounded-lg cursor-pointer">
          <p class="ms-3">Choose dates</p>
        </div>

        <div id="event-dates-dropdown" class="hidden absolute bg-black border border-gray-400 rounded-lg text-gray-400">
          <p class="m-2">Date from</p>
          <input datepicker type="text" name="date_from" autocomplete="off" id="date-from"
            class="max-w-2xl border-0 text-black placeholder:text-black text-sm rounded-lg focus:ring-secondary block w-full p-2 dark:bg-black dark:placeholder-white dark:text-white dark:focus:ring-secondary cursor-pointer"
            placeholder="{{ today() }}">

          <p class="m-2">Date to</p>
          <input datepicker type="text" name="date_to" autocomplete="off" id="date-to"
            class="max-w-2xl border-0 text-black placeholder:text-black text-sm rounded-lg focus:ring-secondary block w-full p-2 dark:bg-black dark:placeholder-white dark:text-white dark:focus:ring-secondary cursor-pointer"
            placeholder="{{ today() }}">
        </div>
        <svg class="absolute right-2 top-1/2 w-5 fill-current" width="24" height="24" viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M18.601 8.39897C18.269 8.06702 17.7309 8.06702 17.3989 8.39897L12 13.7979L6.60099 8.39897C6.26904 8.06702 5.73086 8.06702 5.39891 8.39897C5.06696 8.73091 5.06696 9.2691 5.39891 9.60105L11.3989 15.601C11.7309 15.933 12.269 15.933 12.601 15.601L18.601 9.60105C18.9329 9.2691 18.9329 8.73091 18.601 8.39897Z"
            fill="rgb(130 130 130)"></path>
        </svg>
      </div>

      <div class="cursor-pointer">
        <p class="text-gray-400">Category</p>
        <select name="category_id"
          class="admin-select w-40 bg-black text-gray-400 border border-gray-400 rounded-lg cursor-pointer">
          <option value="all">All</option>
          {% for category in categories %}
          <option value="{{ category.id }}">{{ category.name }}</option>
          {% endfor %}
        </select>
      </div>

      <div class="cursor-pointer">
        <p class="text-gray-400">Status</p>
        <select name="status"
          class="admin-select w-40 bg-black text-gray-400 border border-gray-400 rounded-lg cursor-pointer">
          <option value="all">All</option>
          <option value="pending">Pending</option>
          <option value="users">Created by users</option>
          <option value="admins">Created by admin</option>
        </select>
      </div>
    </div>

    <div class="my-5 flex justify-center">
      <button type="submit"
        class="link p-2 w-44 text-center text-secondary border border-secondary rounded-xl transition-colors duration-200">
        Apply
      </button>
    </div>
  </form>

  <table class="w-full text-sm text-left text-black dark:text-gray-400">
    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:text-black dark:bg-secondary">
      <tr>
        <th scope="col" class="px-6 py-3">#</th>
        <th scope="col" class="px-6 py-3">Name</th>
        <th scope="col" class="px-6 py-3">url</th>
        <th scope="col" class="px-6 py-3">date</th>
        <th scope="col" class="px-6 py-3">days from now</th>
        <th scope="col" class="px-6 py-3">created_by</th>
        <th scope="col" class="px-6 py-3">approved</th>
      </tr>
    </thead>

    <tbody>
      {% for event in events %}
      <tr class="bg-white border-b dark:bg-black dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
        <td class="w-4 p-4">
          <div class="flex items-center">
            {{ loop.index }}
          </div>
        </td>
        <td scope="row" class="flex items-center px-6 py-4 text-gray-900 whitespace-nowrap dark:text-white">
          <a href="{{ url_for('admin.get_event', event_unique_id=event.unique_id) }}" class="pl-3">
            <div class="text-base font-semibold">{{ event.name }}</div>
            <p>{{ event.location.name }} <span>{{ event.category.name }}</span></p>
          </a>
        </td>
        <td class="p-4 text-base font-normal text-gray-900 whitespace-nowrap dark:text-white">
          {{ event.url }}
        </td>
        <td class="p-4 space-x-2 whitespace-nowrap">
          {{ date_from_datetime(event.date_time) }}
        </td>
        <td class="p-4 space-x-2 whitespace-nowrap">
          {{ time_delta(event.date_time) }}
        </td>
        <td class="p-4 space-x-2 whitespace-nowrap">
          {{ event.creator.username }}
        </td>
        <td class="p-4 space-x-2 whitespace-nowrap">
          {{ event.approved }}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/admin.js') }}" type="text/javascript" defer></script>
{% endblock %}